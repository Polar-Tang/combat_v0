local require = require(script.Parent.loader).load(script)

local ALL_ABILITIES = {
	["M1"] = require("M1"),
	["Sprint"] = require("Sprint"),
	["Heavy"] = require("Heavy"),
	["Blocking"] = require("Blocking"),
}

local AbilityBuilder = {}
AbilityBuilder.__index = AbilityBuilder

-- The pop drilling to service bag ends... HERE!
function AbilityBuilder.new(char, serviceBag)
	return setmetatable({
        char = char,
		_map = {},
		_serviceBag = serviceBag
	}, AbilityBuilder)
end

type WeaponStats = {
	_cooldown: number?,
	damage: number?,
	heavy_damage: number?,
	_serviceBag : any,
}

function AbilityBuilder:Add(inputKey, abilityName, config: WeaponStats)
	local AbilityClass = ALL_ABILITIES[abilityName]
	-- Get the cooldown controller from service bag to every ability

	config._serviceBag = self._serviceBag
	self._map[inputKey] = AbilityClass.new(config)
	return self
end

function AbilityBuilder:Build()
	return self._map
end

return AbilityBuilder
