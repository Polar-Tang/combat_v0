-- Weapon.lua
local require = require(script.Parent.loader).load(script)
local get_trail = require("get_trail")
local WeaponBase = {}
WeaponBase.__index = WeaponBase

type weaponBaseAbilities = {
	["M1"] : EnumItem,
	["Sprint"] : EnumItem,
	["Heavy"] : EnumItem,
	["Blocking"] : EnumItem,
}

type WeaponBase = {
	char : Model,
	-- attacks : weaponAbilities,
}

type weaponStats = {
	damage: number,
	heavy_damage: number,
	block_reset_time : number,
	parry_time : number,
	walk_speed_normal: number,
	walk_speed_blocking: number,
}

function WeaponBase.new(char: Model, serviceBag, config: weaponStats): WeaponBase
	local self = setmetatable({
		char = char,
		attacks = nil,
		_serviceBag = serviceBag,
		block_reset_time = config.block_reset_time,
		parry_time = config.parry_time,
		walk_speed_normal = config.walk_speed_normal,
		walk_speed_blocking = config.walk_speed_blocking,
	} :: WeaponBase, WeaponBase)
	
	-- enable the trail for the hitbox
	local trail = get_trail(char)
	if trail then
		trail.Enabled = true
	end
	
	return self
end
function WeaponBase:_createAbilities()
	error("Overwrite this method in child class")
end

function WeaponBase:Execute()
	error("Overwrite this method in child class")
end

function WeaponBase:Start()
	self:_createAbilities()
end

function WeaponBase:Destroy()
	self=nil
end


-- This will loop abilities, setting new ones based on the weapon type
--[[function Weapon:Start(weaponAbilities: {[string]})
	for keyCode, abilityName in pairs(weaponAbilities) do
		local abilityClass = assert(ALL_ABILITIES[abilityName], "Ability "..abilityName.." not found")
		self[keyCode] = abilityClass.new({
			name = abilityName,
		})
	end
end
]]
return WeaponBase
